import{_ as ie}from"./Loading.5d8fff2d.js";import{a as ue,_ as L}from"./Button.f151897d.js";import{_ as G,b as N,a as re}from"./Input.vue.1a2fc455.js";import{_ as ce}from"./TaskTagsView.vue.759a05ec.js";import{_ as W,a as me}from"./Toggle.vue.68b9afc4.js";import{a as x,y as z,C as de,o as s,j as m,F as $,A as C,c as f,i as b,u as ve,I as M,D as T,J as S,K as fe,r as ke,L as pe,k as h,e as k,t as B,s as c,w as A,h as I,x as D,M as j,N as Y,f as U,O as Ve,z as q,E as H,B as ge,b as we,q as he,P as ye}from"./entry.851d371b.js";import{D as xe,_ as _e}from"./index.3cd2ef10.js";import{_ as Te}from"./Label.vue.bf611525.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./nuxt-link.2687c399.js";const Ie={class:"flex mt-1 gap-2 text-[.5rem] items justify-end flex-wrap"},be=x({__name:"TaskTagsEdit",props:{task:null,showTags:{type:Boolean}},async setup(e){let n,i;const a=([n,i]=z(()=>de()),n=await n,i(),n);return(t,u)=>{const l=W;return s(),m("div",Ie,[(s(!0),m($,null,C(ve(a).tags,o=>(s(),f(l,{key:o.id,"model-value":o.data.tasks.includes(e.task.id),class:b(["whitespace-nowrap","!h-auto","!px-2","!py-1","rounded-full",{"opacity-50":!o.isAvailable}]),label:o.name,"onUpdate:modelValue":d=>{d?o.taskAdd(e.task):o.taskRemove(e.task)}},null,8,["model-value","class","label","onUpdate:modelValue"]))),128))])}}}),F=()=>new Promise(e=>requestAnimationFrame(()=>e())),R=e=>new Promise(n=>setTimeout(n,e)),$e=x({__name:"Height",props:{modelValue:{type:Boolean},duration:{default:300}},setup(e){const n=M(e,"modelValue");let i=T(e.modelValue),a=T("auto"),t=T(1);const u=T(null);return S(n,async()=>{if(e.modelValue){i.value=!0,a.value="auto",await fe();const l=u.value?.getBoundingClientRect()??{height:0};a.value="0",await F(),a.value=`${l.height}px`,await R(e.duration),a.value="auto",t.value=0,await F(),t.value=1}else{const l=u.value?.getBoundingClientRect()??{height:0};a.value=`${l.height}px`,t.value=0,await R(e.duration),a.value="0",await R(e.duration),i.value=!1}},{immediate:!0}),(l,o)=>i.value?(s(),m("div",{key:0,ref_key:"el",ref:u,style:pe({height:a.value,opacity:t.value,"transition-duration":`${e.duration}ms`}),class:"transition-all ease-in-out"},[ke(l.$slots,"default")],4)):h("",!0)}}),Ae={class:"flex flex-col"},Ee=x({__name:"Multiline",props:{text:null},setup(e){const n=k(()=>e.text.trim().split(`
`).map(i=>i.trim()||" "));return(i,a)=>(s(),m("div",Ae,[(s(!0),m($,null,C(n.value,(t,u)=>(s(),m("div",{key:u},B(t),1))),128))]))}}),Ce={class:"absolute top-0 -left-6 w-6 flex items-center justify-center"},Be=x({__name:"ViewItem",props:{item:null,isParentCompleted:{type:Boolean}},setup(e){const n=k(()=>e.item[3].length),i=k(()=>e.item[3].filter(l=>l[1]).length);let a=T(!1);const t=k(()=>n.value?i.value===n.value:e.item[1]);S([t,n],()=>{n.value&&(e.item[1]=t.value)},{immediate:!0});function u(){if(n.value){a.value=!a.value;return}e.item[1]=!e.item[1]}return(l,o)=>{const d=J,V=$e,v=ue,_=Ee,w=G;return s(),m("li",{class:b(["flex-grow",{"opacity-50":!e.isParentCompleted&&t.value},"list-none","relative","pl-5"])},[c(V,{modelValue:a.value,"onUpdate:modelValue":o[0]||(o[0]=y=>a.value=y)},{default:A(()=>[c(d,{checklist:e.item[3],class:"-ml-1.5 pl-2 pt-1 border-t border-l rounded-tl border-secondary/20","is-parent-completed":e.isParentCompleted||t.value},null,8,["checklist","is-parent-completed"])]),_:1},8,["modelValue"]),I("div",{class:"p-2 flex justify-between items-end",onClick:o[1]||(o[1]=y=>u())},[I("div",{class:b(["transition-all",t.value?"decoration-current":"decoration-transparent","line-through","relative"])},[I("span",Ce,[c(v,{name:n.value?"fa6-solid:chevron-up":"fa6-solid:circle",class:b(["transition-transform duration-[600ms]",n.value?"text-[10px]":"text-[6px]",{"rotate-90":!a.value}])},null,8,["name","class"]),D("  ")]),c(_,{text:e.item[0]},null,8,["text"])],2),I("div",null,[c(w,{done:i.value,total:n.value},null,8,["done","total"])])])],2)}}}),J=x({__name:"View",props:{checklist:null,isParentCompleted:{type:Boolean}},emits:["update"],setup(e,{emit:n}){const i=M(e,"checklist");return S(i,()=>{e.checklist.sort((a,t)=>+t[1]-+a[1]||a[3].length-t[3].length||e.checklist.indexOf(a)-e.checklist.indexOf(t)),n("update")},{deep:!0,immediate:!0}),(a,t)=>{const u=Be,l=me;return s(),f(l,{group:"",tag:"ul",class:"flex flex-col gap-1 select-none"},{default:A(()=>[(s(!0),m($,null,C(e.checklist,o=>(s(),f(u,{key:o[2],item:o,"is-parent-completed":e.isParentCompleted},null,8,["item","is-parent-completed"]))),128))]),_:1})}}}),Se=x({__name:"EditItem",props:{item:null,isParentCompleted:{type:Boolean}},emits:["refresh","remove"],setup(e,{emit:n}){const i=k(()=>e.item[3].length),a=k(()=>e.item[3].filter(u=>u[1]).length),t=k(()=>i.value?a.value===i.value:e.item[1]);return S([t,i],()=>{i.value&&(e.item[1]=t.value)},{immediate:!0}),(u,l)=>{const o=K,d=L,V=N;return s(),m("div",null,[c(o,{modelValue:e.item[3],"onUpdate:modelValue":[l[0]||(l[0]=v=>e.item[3]=v),l[1]||(l[1]=v=>n("refresh"))],class:"ml-3.5 mt-2 pl-[1.375rem] border-t border-l rounded-tl border-secondary/20"},null,8,["modelValue"]),I("div",{class:b(["flex","items-start",{"line-through opacity-50":e.item[1]}])},[c(d,{icon:"fa6-solid:xmark",flat:"",class:"pl-0",onClick:l[2]||(l[2]=v=>n("remove"))}),c(V,{modelValue:e.item[0],"onUpdate:modelValue":l[3]||(l[3]=v=>e.item[0]=v),flat:"",class:b(["flex-grow","flex-shrink"]),autogrow:""},null,8,["modelValue"])],2)])}}}),Pe={class:"relative flex items-start gap-2"},K=x({__name:"Edit",props:{modelValue:null},emits:["update:modelValue"],setup(e,{emit:n}){const i=`_${j()}`;let a=k({get(){return e.modelValue.sort((o,d)=>+d[1]-+o[1]),e.modelValue},set(o){n("update:modelValue",o)}});function t(){a.value=Ve([...a.value])}function u(){a.value.push([l.value,!1,j(),[]]),t(),l.value="",document.getElementById(i)?.focus()}let l=T("");return(o,d)=>{const V=Se,v=N,_=L,w=Y("auto-animate");return U((s(),m("div",null,[(s(!0),m($,null,C(a.value,(y,g)=>(s(),f(V,{key:y[2],item:y,onRefresh:d[0]||(d[0]=r=>t()),onRemove:r=>a.value=a.value.filter((O,P)=>P!==g)},null,8,["item","onRemove"]))),128)),U((s(),m("div",Pe,[c(v,{id:i,modelValue:l.value,"onUpdate:modelValue":d[1]||(d[1]=y=>l.value=y),class:"flex-grow flex-shrink",placeholder:"Add list item",flat:"",autogrow:""},null,8,["modelValue"]),l.value?(s(),f(_,{key:0,icon:"fa6-solid:plus",flat:"",class:"pr-0",onClick:d[2]||(d[2]=y=>u())})):h("",!0)])),[[w,{duration:300}]])])),[[w,{duration:300}]])}}}),Re={key:0,class:"flex gap-4 items-center"},De={class:"flex-grow"},Ue=x({__name:"RelationsRow",props:{relations:null,row:null,canSucc:{type:Boolean},canPred:{type:Boolean}},setup(e){const n=k({get(){return e.relations.hasSuccessor(e.row)},set(a){a?e.relations.addSuccessor(e.row):e.relations.removeSuccessor(e.row)}}),i=k({get(){return e.relations.hasPredecessor(e.row)},set(a){a?e.relations.addPredecessor(e.row):e.relations.removePredecessor(e.row)}});return(a,t)=>{const u=W;return e.canPred||e.canSucc?(s(),m("div",Re,[c(u,{modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=l=>i.value=l),disabled:!e.canPred||n.value,icon:"fa6-solid:diagram-predecessor"},null,8,["modelValue","disabled"]),I("div",De,["title"in e.row?(s(),m($,{key:0},[D(B(e.row.title),1)],64)):"name"in e.row?(s(),m($,{key:1},[D(B(e.row.name),1)],64)):h("",!0)]),c(u,{modelValue:n.value,"onUpdate:modelValue":t[1]||(t[1]=l=>n.value=l),disabled:!e.canSucc||i.value,icon:"fa6-solid:diagram-successor"},null,8,["modelValue","disabled"])])):h("",!0)}}}),Le=x({__name:"Relations",props:{task:null},async setup(e){let n,i;const a=([n,i]=z(()=>q()),n=await n,i(),n);let t=T([]);return H(async()=>{t.value=await Promise.all(a.tasks.map(async u=>[u,!await e.task.relations.hasInDirectSuccessors(u.id),!await e.task.relations.hasInDirectPredecessors(u.id)]))}),(u,l)=>{const o=Ue,d=Te,V=Y("auto-animate");return U((s(),m("div",null,[c(d,{label:"Relations",class:"flex flex-col gap-2 pb-2"},{default:A(()=>[(s(!0),m($,null,C(t.value,([v,_,w])=>(s(),f(o,{key:v.id,relations:e.task.relations,row:v,"can-pred":_,"can-succ":w},null,8,["relations","row","can-pred","can-succ"]))),128))]),_:1})])),[[V,{duration:300}]])}}}),Ne=I("div",{class:"flex-grow"},null,-1),We={key:1,class:"flex-grow"},Ke=x({__name:"[id]",setup(e){const n=ge(),i=we(),a=q();let t=T(null);const u=k(()=>n.params.id);H(async()=>t.value=await ye(u.value));const l={VIEW:1,EDIT:2,AVAILABILITY:3,RELATIONS:4,TAGS:5};let o=T(l.VIEW),d=k(()=>o.value===l.VIEW),V=k({get(){return o.value===l.EDIT},set(g){o.value=g?l.EDIT:l.VIEW}}),v=k({get(){return o.value===l.AVAILABILITY},set(g){o.value=g?l.AVAILABILITY:l.VIEW}}),_=k({get(){return o.value===l.RELATIONS},set(g){o.value=g?l.RELATIONS:l.VIEW}}),w=k({get(){return o.value===l.TAGS},set(g){o.value=g?l.TAGS:l.VIEW}});async function y(){const{value:g}=await xe.confirm({message:"Are you sure you want to delete this task?"});g&&(await a.taskDelete(u.value),i.back())}return(g,r)=>{const O=ie,P=L,Q=G,X=re,Z=ce,ee=be,te=J,le=K,ae=_e,ne=Le,oe=N,E=W,se=he;return t.value?(s(),f(se,{key:1,name:"common"},{header:A(()=>[c(P,{icon:"fa6-solid:trash",flat:"",onClick:y}),Ne,I("div",{class:b(["pr-3","flex","flex-col","items-end","gap-1","transition-opacity","duration-300",{"opacity-50":!t.value.isAvailable}])},[I("div",{class:b(["transition-all","line-through",t.value.isAvailable?"decoration-transparent":"decoration-current","text-primary"])},B(t.value.title),3),c(Q,{total:t.value.checklistTotal,done:t.value.checklistDone},null,8,["total","done"]),c(X,{"ms-switch-after":t.value.tsSwitchAt,"is-available":t.value.isAvailable},null,8,["ms-switch-after","is-available"]),w.value?h("",!0):(s(),f(Z,{key:0,task:t.value},null,8,["task"]))],2)]),default:A(()=>[(s(),m("div",{key:o.value,class:"px-4 pb-1"},[w.value?(s(),f(ee,{key:0,task:t.value},null,8,["task"])):h("",!0),d.value?(s(),f(te,{key:"checklist-view",checklist:t.value.checklist,onUpdate:r[0]||(r[0]=p=>{t.value&&(t.value.checklist=t.value.checklist)})},null,8,["checklist"])):h("",!0),V.value?(s(),f(le,{key:"checklist-edit",modelValue:t.value.checklist,"onUpdate:modelValue":[r[1]||(r[1]=p=>t.value.checklist=p),r[2]||(r[2]=p=>{t.value&&(t.value.checklist=t.value.checklist)})]},null,8,["modelValue"])):h("",!0),v.value?(s(),f(ae,{key:"availability",available:t.value},null,8,["available"])):h("",!0),_.value?(s(),f(ne,{key:"relations",task:t.value},null,8,["task"])):h("",!0)]))]),footer:A(()=>[V.value?(s(),f(oe,{key:0,modelValue:t.value.title,"onUpdate:modelValue":r[3]||(r[3]=p=>t.value.title=p),flat:"",class:"flex-grow"},null,8,["modelValue"])):(s(),m("div",We)),c(E,{modelValue:_.value,"onUpdate:modelValue":r[4]||(r[4]=p=>_.value=p),icon:"fa6-solid:diagram-project",flat:""},null,8,["modelValue"]),c(E,{modelValue:v.value,"onUpdate:modelValue":r[5]||(r[5]=p=>v.value=p),icon:"mdi:calendar-clock",flat:""},null,8,["modelValue"]),c(E,{modelValue:w.value,"onUpdate:modelValue":r[6]||(r[6]=p=>w.value=p),icon:"fa6-solid:tags",flat:""},null,8,["modelValue"]),c(E,{modelValue:V.value,"onUpdate:modelValue":r[7]||(r[7]=p=>V.value=p),icon:"fa6-solid:pencil",flat:""},null,8,["modelValue"]),t.value.checklistTotal?h("",!0):(s(),f(E,{key:2,modelValue:t.value.isDone,"onUpdate:modelValue":r[8]||(r[8]=p=>t.value.isDone=p),icon:"fa6-solid:check",flat:""},null,8,["modelValue"]))]),_:1})):(s(),f(O,{key:0}))}}});export{Ke as default};

!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="04425aa5-5202-4ba4-9565-da80ea6325a7")}catch(e){}}()
//# debugId=04425aa5-5202-4ba4-9565-da80ea6325a7
//# sourceMappingURL=_id_.a5112ca2.js.map